## 事务隔离


## 隔离性与隔离级别

### 隔离性

- 脏读
  - 事务a读取了事务b未提交的数据
- 幻读
  - 事务a前后获取的数据总量不一致
- 不可重复读
  - 事务a前后两次读取的数据不一样，可能是其他事务在中途修改了数据


### 隔离级别（隔离的越深，效率就越低）

- 读未提交：一个事务未提交时，其他事务能看到它更新的结果
- 读已提交：一个事务提交时，其他事务才可以看到它更新的结果，每个事务的视图时在执行的时候创建的
- 可重复读：开启一个事务的时候，快照当前时间点之前的活跃事务（开启一个事务的时候创建视图），此后的其他事务进行的更新都不可见
- 串行化：读写数据会加锁，事务的执行时串行的



### 事务隔离级别的实现


- mysql进行数据更新的时候，会记录一条回滚操作，通过回滚操作，都可以得到前一个状态的值
- 长事务：很老的事务视图，可能会随时访问数据库里面的任何数据，所以在commit之前所有用到回滚记录都需要保留，这就导致占用大量的存储空间




### 事务的启动方式

- 显示启动
  - begin 或者 start transaction
- set autocommit=1